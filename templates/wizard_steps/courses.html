<form id="step-form" method="post" action="/wizard?step=2">
  <div class="space-y-6">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-lg font-semibold text-gray-700">শিক্ষামূলক কোর্স/সেশন</h3>
      <button type="button" id="add-course" 
              class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
        নতুন কোর্স যুক্ত করুন
      </button>
    </div>

    <div id="courses-container">
      {% if courses and courses|length > 0 %}
        {% for course in courses %}
        <div class="course-item bg-gray-50 p-4 rounded-lg border border-gray-200 mb-4">
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">বিভাগ</label>
              <select name="course_category_id[]" required
                      class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-cyan-500">
                <option value="">বিভাগ নির্বাচন করুন</option>
                {% for category in course_categories %}
                <option value="{{ category.id }}" 
                        {% if course.category_id == category.id %}selected{% endif %}>
                  {{ category.name }}
                </option>
                {% endfor %}
              </select>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">কোর্সের নাম</label>
              <input type="text" name="course_name[]" value="{{ course.course_name }}" required
                     class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-cyan-500">
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">সেশন সংখ্যা</label>
              <input type="number" name="sessions_conducted[]" value="{{ course.sessions_conducted }}" min="0"
                     class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-cyan-500">
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">অংশগ্রহণকারী</label>
              <input type="number" name="participants[]" value="{{ course.participants }}" min="0"
                     class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-cyan-500">
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">সময়কাল (ঘন্টা)</label>
              <input type="number" name="duration_hours[]" value="{{ course.duration_hours }}" min="0" step="0.5"
                     class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-cyan-500">
            </div>

            <div class="flex items-end">
              <button type="button" class="remove-course px-3 py-2 bg-red-500 text-white rounded hover:bg-red-600 transition-colors">
                মুছে ফেলুন
              </button>
            </div>
          </div>
        </div>
        {% endfor %}
      {% else %}
        <div class="course-item bg-gray-50 p-4 rounded-lg border border-gray-200 mb-4">
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">বিভাগ</label>
              <select name="course_category_id[]" required
                      class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-cyan-500">
                <option value="">বিভাগ নির্বাচন করুন</option>
                {% for category in course_categories %}
                <option value="{{ category.id }}">{{ category.name }}</option>
                {% endfor %}
              </select>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">কোর্সের নাম</label>
              <input type="text" name="course_name[]" required
                     class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-cyan-500">
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">সেশন সংখ্যা</label>
              <input type="number" name="sessions_conducted[]" min="0" value="0"
                     class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-cyan-500">
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">অংশগ্রহণকারী</label>
              <input type="number" name="participants[]" min="0" value="0"
                     class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-cyan-500">
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">সময়কাল (ঘন্টা)</label>
              <input type="number" name="duration_hours[]" min="0" step="0.5" value="0"
                     class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-cyan-500">
            </div>

            <div class="flex items-end">
              <button type="button" class="remove-course px-3 py-2 bg-red-500 text-white rounded hover:bg-red-600 transition-colors">
                মুছে ফেলুন
              </button>
            </div>
          </div>
        </div>
      {% endif %}
    </div>
  </div>
</form>

<script>
// Course management
document.getElementById('add-course').addEventListener('click', function() {
  const container = document.getElementById('courses-container');
  const courseItem = container.querySelector('.course-item').cloneNode(true);
  
  // Clear values
  courseItem.querySelectorAll('input').forEach(input => input.value = input.type === 'number' ? '0' : '');
  courseItem.querySelectorAll('select').forEach(select => select.selectedIndex = 0);
  
  container.appendChild(courseItem);
  
  // Add remove functionality to new item
  courseItem.querySelector('.remove-course').addEventListener('click', function() {
    if (container.children.length > 1) {
      courseItem.remove();
    }
  });
});

// Add remove functionality to existing items
document.querySelectorAll('.remove-course').forEach(button => {
  button.addEventListener('click', function() {
    const container = document.getElementById('courses-container');
    if (container.children.length > 1) {
      button.closest('.course-item').remove();
    }
  });
});
</script>
