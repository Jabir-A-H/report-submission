<form id="step-form" method="post" action="/wizard?step=6">
  <div class="space-y-6">
    <div class="flex justify-between items-center mb-4">
      <h3 class="text-lg font-semibold text-gray-700">অতিরিক্ত কার্যক্রম</h3>
      <button type="button" id="add-extra" 
              class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">
        নতুন কার্যক্রম যুক্ত করুন
      </button>
    </div>

    <div id="extras-container">
      {% if extras and extras|length > 0 %}
        {% for extra in extras %}
        <div class="extra-item bg-gray-50 p-4 rounded-lg border border-gray-200 mb-4">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">বিভাগ</label>
              <select name="extra_category_id[]" required
                      class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-cyan-500">
                <option value="">বিভাগ নির্বাচন করুন</option>
                {% for category in extra_categories %}
                <option value="{{ category.id }}" 
                        {% if extra.category_id == category.id %}selected{% endif %}>
                  {{ category.name }}
                </option>
                {% endfor %}
              </select>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">কার্যক্রমের নাম</label>
              <input type="text" name="activity_name[]" value="{{ extra.activity_name }}" required
                     class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-cyan-500">
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">অংশগ্রহণকারী</label>
              <input type="number" name="participants[]" value="{{ extra.participants }}" min="0"
                     class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-cyan-500">
            </div>

            <div class="flex items-end">
              <button type="button" class="remove-extra px-3 py-2 bg-red-500 text-white rounded hover:bg-red-600 transition-colors">
                মুছে ফেলুন
              </button>
            </div>

            <div class="md:col-span-2">
              <label class="block text-sm font-medium text-gray-700 mb-1">বিবরণ</label>
              <textarea name="description[]" rows="3"
                        class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-cyan-500">{{ extra.description if extra.description else '' }}</textarea>
            </div>
          </div>
        </div>
        {% endfor %}
      {% else %}
        <div class="extra-item bg-gray-50 p-4 rounded-lg border border-gray-200 mb-4">
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">বিভাগ</label>
              <select name="extra_category_id[]" required
                      class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-cyan-500">
                <option value="">বিভাগ নির্বাচন করুন</option>
                {% for category in extra_categories %}
                <option value="{{ category.id }}">{{ category.name }}</option>
                {% endfor %}
              </select>
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">কার্যক্রমের নাম</label>
              <input type="text" name="activity_name[]" required
                     class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-cyan-500">
            </div>

            <div>
              <label class="block text-sm font-medium text-gray-700 mb-1">অংশগ্রহণকারী</label>
              <input type="number" name="participants[]" min="0" value="0"
                     class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-cyan-500">
            </div>

            <div class="flex items-end">
              <button type="button" class="remove-extra px-3 py-2 bg-red-500 text-white rounded hover:bg-red-600 transition-colors">
                মুছে ফেলুন
              </button>
            </div>

            <div class="md:col-span-2">
              <label class="block text-sm font-medium text-gray-700 mb-1">বিবরণ</label>
              <textarea name="description[]" rows="3"
                        class="w-full p-2 border border-gray-300 rounded focus:ring-2 focus:ring-cyan-500"></textarea>
            </div>
          </div>
        </div>
      {% endif %}
    </div>
  </div>
</form>

<script>
// Extra management
document.getElementById('add-extra').addEventListener('click', function() {
  const container = document.getElementById('extras-container');
  const extraItem = container.querySelector('.extra-item').cloneNode(true);
  
  // Clear values
  extraItem.querySelectorAll('input').forEach(input => input.value = input.type === 'number' ? '0' : '');
  extraItem.querySelectorAll('select').forEach(select => select.selectedIndex = 0);
  extraItem.querySelectorAll('textarea').forEach(textarea => textarea.value = '');
  
  container.appendChild(extraItem);
  
  // Add remove functionality to new item
  extraItem.querySelector('.remove-extra').addEventListener('click', function() {
    if (container.children.length > 1) {
      extraItem.remove();
    }
  });
});

// Add remove functionality to existing items
document.querySelectorAll('.remove-extra').forEach(button => {
  button.addEventListener('click', function() {
    const container = document.getElementById('extras-container');
    if (container.children.length > 1) {
      button.closest('.extra-item').remove();
    }
  });
});
</script>
