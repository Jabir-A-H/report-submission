{% extends 'base.html' %} {% block title %}ইউজার ব্যবস্থাপনা{% endblock %} {%
block content %}
<div class="container mx-auto px-4 py-8">
  <div class="page-header">
    <h1 class="page-title">ইউজার ব্যবস্থাপনা</h1>
    <p class="page-subtitle">ইউজার অনুমোদন, রিজেক্ট, জোন অ্যাসাইন/রিএসাইন, ও সম্পাদনা করুন</p>
    
    <!-- Fix Sequence Button -->
    <div class="mt-4">
      <a href="{{ url_for('fix_sequence') }}" 
         onclick="return confirm('এটি ডাটাবেস সিকোয়েন্স ঠিক করবে। চালিয়ে যেতে চান?')"
         class="modern-btn btn-warning">
        <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"></path>
          <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"></path>
        </svg>
        ডাটাবেস সিকোয়েন্স ঠিক করুন
      </a>
    </div>
  </div>
  
  <div class="max-w-6xl mx-auto modern-card">
    <div class="table-container">
      <table class="modern-table">
        <thead>
          <tr>
            <th>আইডি</th>
            <th>নাম</th>
            <th>ইমেইল</th>
            <th>জোন</th>
            <th>রোল</th>
            <th>স্ট্যাটাস</th>
            <th>অ্যাকশন</th>
          </tr>
        </thead>
      <tbody>
        {% for people in people %}
        <tr class="table-row-animate">
          <td class="font-mono">{{ people.user_id }}</td>
          <td class="font-semibold">{{ people.name }}</td>
          <td>{{ people.email }}</td>
          <td>{{ people.zone.name if people.zone else '—' }}</td>
          <td>
            <span class="px-3 py-1 rounded-full text-xs font-semibold {% if people.role == 'admin' %}bg-purple-100 text-purple-800{% else %}bg-blue-100 text-blue-800{% endif %}">
              {{ people.role }}
            </span>
          </td>
          <td>
            {% if people.active %}
              <span class="px-3 py-1 rounded-full text-xs font-semibold bg-green-100 text-green-800">Active</span>
            {% else %}
              <span class="px-3 py-1 rounded-full text-xs font-semibold bg-yellow-100 text-yellow-800">Pending</span>
            {% endif %}
          </td>
          <td>
            <div class="flex flex-col gap-2 min-w-max">
              <form method="post" action="/users" onsubmit="return confirm('আপনি কি নিশ্চিতভাবে এই ইউজারটি অনুমোদন করতে চান?');">
                <input type="hidden" name="user_id" value="{{ people.id }}">
                <input type="hidden" name="action" value="approve">
                <button type="submit" class="modern-btn btn-success text-sm w-full">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"></path>
                  </svg>
                  অনুমোদন
                </button>
              </form>
              
              <form method="post" action="/users" onsubmit="return confirm('আপনি কি নিশ্চিতভাবে এই ইউজারটি রিজেক্ট করতে চান?');">
                <input type="hidden" name="user_id" value="{{ people.id }}">
                <input type="hidden" name="action" value="reject">
                <button type="submit" class="modern-btn btn-danger text-sm w-full">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
                  </svg>
                  ডিলিট করুন
                </button>
              </form>
              
              <form method="post" action="/users" onsubmit="return confirm('জোন পরিবর্তন করতে চান?');" class="flex gap-2">
                <input type="hidden" name="user_id" value="{{ people.id }}">
                <input type="hidden" name="action" value="assign_zone">
                <select name="zone_id" class="modern-input modern-select flex-1 text-sm">
                  {% for zone in zones %}
                    <option value="{{ zone.id }}" {% if people.zone_id == zone.id %}selected{% endif %}>{{ zone.name }}</option>
                  {% endfor %}
                </select>
                <button type="submit" class="modern-btn btn-secondary text-sm">
                  <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"></path>
                  </svg>
                  আপডেট
                </button>
              </form>
            </div>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
    </div>
  </div>
</div>
{% endblock %}
