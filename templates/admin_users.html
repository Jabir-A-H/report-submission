{% extends 'base.html' %}
{% block title %}ইউজার ব্যবস্থাপনা{% endblock %}
{% block content %}
<div class="container mx-auto px-4 py-8 animate-fade-in">
  <div class="text-center mb-8">
    <h1 class="text-3xl font-bold text-cyan-700 mb-2">ইউজার ব্যবস্থাপনা</h1>
    <p class="text-gray-600">ইউজার অনুমোদন, রোল পরিবর্তন, ও মুছুন</p>
  </div>
  <div class="max-w-4xl mx-auto bg-white rounded-2xl shadow-xl p-8">
    <table class="min-w-full border-separate border-spacing-y-1 border-0 rounded shadow text-sm">
      <thead class="bg-cyan-50">
        <tr class="text-cyan-700">
          <th class="px-4 py-2 border-b">ইমেইল</th>
          <th class="px-4 py-2 border-b">জোন</th>
          <th class="px-4 py-2 border-b">রোল</th>
          <th class="px-4 py-2 border-b">স্ট্যাটাস</th>
          <th class="px-4 py-2 border-b">অ্যাকশন</th>
        </tr>
      </thead>
      <tbody>
        {% for user in users %}
        <tr class="hover:bg-cyan-50">
          <td class="px-4 py-2 border-b">{{ user.email }}</td>
          <td class="px-4 py-2 border-b">{{ user.zone.name }}</td>
          <td class="px-4 py-2 border-b">{{ user.role }}</td>
          <td class="px-4 py-2 border-b">
            {% if user.is_active %}
            <span class="text-green-600 font-bold">সক্রিয়</span>
            {% else %}
            <span class="text-yellow-600 font-bold">অপেক্ষমাণ</span>
            {% endif %}
          </td>
          <td class="px-4 py-2 border-b">
            {% if not user.is_active %}
            <form method="post" action="/approve_user/{{ user.id }}" onsubmit="return confirm('আপনি কি নিশ্চিতভাবে এই ইউজারটি অনুমোদন করতে চান?');">
              <button type="submit" class="px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors">অনুমোদন</button>
            </form>
            {% endif %}
            <form method="post" action="/delete_user/{{ user.id }}" onsubmit="return confirm('আপনি কি নিশ্চিতভাবে এই ইউজারটি মুছতে চান?');">
              <button type="submit" class="px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors">মুছুন</button>
            </form>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}
                    <button
                      type="submit"
                      class="bg-green-600 hover:bg-green-700 text-white font-bold py-1 px-3 rounded"
                    >
                      Approve
                    </button>
                  </form>
                  {% else %}
                  <span class="text-gray-400">---</span>
                  {% endif %}
                </td>
              </tr>
              {% endfor %}
            </tbody>
          </table>
        </div>
        <div class="text-center mt-4 fade-in">
          <a
            href="/admin/reports"
            class="text-cyan-700 hover:underline font-semibold transition-colors duration-200"
            >রিপোর্টে ফিরে যান</a
          >
        </div>
      </div>
    </div>
    <script>
      function approveUser(e, userId) {
        e.preventDefault();
        fetch(`/admin/approve_user/${userId}`, { method: "POST" }).then((r) =>
          r.ok ? location.reload() : alert("Failed to approve")
        );
        return false;
      }
    </script>
  </body>
</html>
